---
title: Automating release notes
date: 2021-04-14
tags:
  - dev
  - workflow
  - git
layout: post
---

At work, we have a setup that builds and deploy our app to production when pushing to the `master` branch. We also use git tags so we can have versioned releases.

I wanted to automate this process like so:
- Use a single command that bumps version, adds git tag and creates release commit
- Auto-generate changelog using commits between branch tip and last tag
- Auto-generate release notes in release tab on GitHub (should be same as last changelog entry)
- Post release notes into Slack channel to notify team members about deployment

To achieve this I combined several services.

1. [`standard-version`](https://github.com/conventional-changelog/standard-version) to handle the first two requirements. I did it by running `npx standard-version`.

2. [`GitHub Automatic Releases`](https://github.com/marvinpinto/action-automatic-releases) action to generate GitHub release notes on tag push. It doesn't use `CHANGELOG.md` but looks at the same commit set and extracts it almost identically. I was fine with that.

My `.github/workflows/release.yml` file:

```shell
name: Release

on:
  push:
    tags:
      - "v*"

jobs:
  tagged-release:
    name: "Tagged Release"
    runs-on: "ubuntu-latest"

    steps:
      - uses: "marvinpinto/action-automatic-releases@latest"
        with:
          repo_token: "${{ secrets.GITHUB_TOKEN }}"
          prerelease: false
```

3. [GitHub's Slack app](https://slack.github.com/) to subscribe to releases in my repo and post them in `#releases` channel.

These are commands I posted in the channel to subscribe _only_ to releases and eliminate other GH chatter:

```
/github subscribe popularlab/REPO-NAME
/github unsubscribe popularlab/REPO-NAME issues,pulls,statuses,commits,public,deployments
```
