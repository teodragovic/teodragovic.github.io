<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Optimizing SVG icon system in Preact</title>

        <style>*,:after,:before{-webkit-box-sizing:border-box;box-sizing:border-box}html{cursor:default;font-size:125%}body,html{height:100%;-webkit-text-size-adjust:100%;-moz-text-size-adjust:100%;-ms-text-size-adjust:100%;text-size-adjust:100%}body{-webkit-tap-highlight-color:rgba(0,0,0,0);-ms-overflow-style:scrollbar;min-height:100%;margin:0;font-size:100%;-webkit-font-kerning:normal;font-kerning:normal;-webkit-font-feature-settings:"liga","kern";font-feature-settings:"liga","kern";text-rendering:optimizeLegibility;font-family:Georgia;line-height:1.2}.homepage{width:100%;height:100%;padding:1rem;text-align:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.homepage-inner{display:block;width:90%;max-width:40rem}.homepage p{font-size:120%;text-transform:lowercase;margin-top:0}@media screen and (min-width:37.5em){.homepage p{font-size:2rem}}.homepage ul{list-style:none;padding:0;margin:0;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-pack:distribute;justify-content:space-around;-ms-flex-wrap:wrap;flex-wrap:wrap}.homepage ul li{-webkit-box-flex:0;-ms-flex:0 1 100px;flex:0 1 100px;margin-bottom:1rem}.homepage a{font-size:1.8rem;-ms-touch-action:manipulation;touch-action:manipulation;color:inherit;display:inline-block;padding:.5rem}@media screen and (min-width:37.5em){.homepage a{font-size:2.5rem}}.icon{overflow:hidden;display:inline-block;width:1em;height:1em;stroke-width:0;stroke:currentColor;fill:currentColor}.icon path{fill:inherit!important}::-moz-selection{background-color:#000;color:#fff;text-shadow:none}::selection{background-color:#000;color:#fff;text-shadow:none}.blog-list,.post{width:100%;max-width:50ch;margin:0 auto;padding:10% 15px}a,a:visited{color:#000}.postlist-item{font-family:sans-serif;padding-bottom:20px;margin-bottom:20px}.postlist-item time{font-size:16px}.postlist-item a{text-decoration:none}.postlist-item h2{font-weight:900;margin-top:0;margin-bottom:10px;text-decoration:underline}.postlist-item p{margin-top:0;text-decoration:none}.post h1,.post h2,.post h3{font-family:sans-serif;font-weight:900;line-height:1}code{background:#eee}code[class*=language-],pre[class*=language-]{font-size:16px;line-height:1.375;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;background:#272822;color:#f8f8f2}pre[class*=language-]{padding:1.5em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#75715e}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.boolean,.token.number,.token.operator{color:#fd971f}.token.property{color:#f4bf75}.token.tag{color:#66d9ef}.token.string{color:#a1efe4}.token.selector{color:#ae81ff}.token.attr-name{color:#fd971f}.language-css .token.string,.style .token.string,.token.entity,.token.url{color:#a1efe4}.token.attr-value,.token.control,.token.directive,.token.keyword,.token.unit{color:#a6e22e}.token.atrule,.token.regex,.token.statement{color:#a1efe4}.token.placeholder,.token.variable{color:#66d9ef}.token.deleted{text-decoration:line-through}.token.inserted{border-bottom:1px dotted #f9f8f5;text-decoration:none}.token.italic{font-style:italic}.token.bold,.token.important{font-weight:700}.token.important{color:#f92672}.token.entity{cursor:help}pre>code.highlight{outline:.4em solid #f92672;outline-offset:.4em}
/*# sourceMappingURL=data:application/json;base64,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LG9CQUFvQixDQUFDLGNBQWMsaUJBQWlCLENBQUMsNkJBQTZCLGVBQWdCLENBQUMsaUJBQWlCLGFBQWEsQ0FBQyxjQUFjLFdBQVcsQ0FBQyxtQkFBbUIsMEJBQTBCLENBQUMsbUJBQW1CIiwiZmlsZSI6ImluZGV4LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIiosKjpiZWZvcmUsKjphZnRlcntib3gtc2l6aW5nOmJvcmRlci1ib3h9aHRtbHtjdXJzb3I6ZGVmYXVsdDtoZWlnaHQ6MTAwJTtmb250LXNpemU6MTI1JTt0ZXh0LXNpemUtYWRqdXN0OjEwMCV9Ym9keXstd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3I6cmdiYSgwLDAsMCwwKTstbXMtb3ZlcmZsb3ctc3R5bGU6c2Nyb2xsYmFyO21pbi1oZWlnaHQ6MTAwJTtoZWlnaHQ6MTAwJTttYXJnaW46MDtmb250LXNpemU6MTAwJTtmb250LWtlcm5pbmc6bm9ybWFsO3RleHQtc2l6ZS1hZGp1c3Q6MTAwJTtmb250LWZlYXR1cmUtc2V0dGluZ3M6XCJsaWdhXCIsXCJrZXJuXCI7dGV4dC1yZW5kZXJpbmc6b3B0aW1pemVMZWdpYmlsaXR5O2ZvbnQtZmFtaWx5Okdlb3JnaWE7bGluZS1oZWlnaHQ6MS4yfS5ob21lcGFnZXt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO3BhZGRpbmc6MXJlbTt0ZXh0LWFsaWduOmNlbnRlcjtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXJ9LmhvbWVwYWdlLWlubmVye2Rpc3BsYXk6YmxvY2s7d2lkdGg6OTAlO21heC13aWR0aDo0MHJlbX0uaG9tZXBhZ2UgcHtmb250LXNpemU6MTIwJTt0ZXh0LXRyYW5zZm9ybTpsb3dlcmNhc2U7bWFyZ2luLXRvcDowfUBtZWRpYSBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDM3LjVlbSl7LmhvbWVwYWdlIHB7Zm9udC1zaXplOjJyZW19fS5ob21lcGFnZSB1bHtsaXN0LXN0eWxlOm5vbmU7cGFkZGluZzowO21hcmdpbjowO2Rpc3BsYXk6ZmxleDtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYXJvdW5kO2ZsZXgtd3JhcDp3cmFwfS5ob21lcGFnZSB1bCBsaXtmbGV4OjAgMSAxMDBweDttYXJnaW4tYm90dG9tOjFyZW19LmhvbWVwYWdlIGF7Zm9udC1zaXplOjEuOHJlbTt0b3VjaC1hY3Rpb246bWFuaXB1bGF0aW9uO2NvbG9yOmluaGVyaXQ7ZGlzcGxheTppbmxpbmUtYmxvY2s7cGFkZGluZzouNXJlbX1AbWVkaWEgc2NyZWVuIGFuZCAobWluLXdpZHRoOiAzNy41ZW0pey5ob21lcGFnZSBhe2ZvbnQtc2l6ZToyLjVyZW19fS5pY29ue292ZXJmbG93OmhpZGRlbjtkaXNwbGF5OmlubGluZS1ibG9jazt3aWR0aDoxZW07aGVpZ2h0OjFlbTtzdHJva2Utd2lkdGg6MDtzdHJva2U6Y3VycmVudENvbG9yO2ZpbGw6Y3VycmVudENvbG9yfS5pY29uIHBhdGh7ZmlsbDppbmhlcml0ICFpbXBvcnRhbnR9OjotbW96LXNlbGVjdGlvbntiYWNrZ3JvdW5kLWNvbG9yOiMwMDA7Y29sb3I6I2ZmZjt0ZXh0LXNoYWRvdzpub25lfTo6c2VsZWN0aW9ue2JhY2tncm91bmQtY29sb3I6IzAwMDtjb2xvcjojZmZmO3RleHQtc2hhZG93Om5vbmV9LmJsb2ctbGlzdCwucG9zdHt3aWR0aDoxMDAlO21heC13aWR0aDo1MGNoO21hcmdpbjowIGF1dG87cGFkZGluZzoxMCUgMTVweH1he2NvbG9yOiMwMDB9YTp2aXNpdGVke2NvbG9yOiMwMDB9LnBvc3RsaXN0LWl0ZW17Zm9udC1mYW1pbHk6c2Fucy1zZXJpZjtwYWRkaW5nLWJvdHRvbToyMHB4O21hcmdpbi1ib3R0b206MjBweH0ucG9zdGxpc3QtaXRlbSB0aW1le2ZvbnQtc2l6ZToxNnB4fS5wb3N0bGlzdC1pdGVtIGF7dGV4dC1kZWNvcmF0aW9uOm5vbmV9LnBvc3RsaXN0LWl0ZW0gaDJ7Zm9udC13ZWlnaHQ6OTAwO21hcmdpbi10b3A6MDttYXJnaW4tYm90dG9tOjEwcHg7dGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZX0ucG9zdGxpc3QtaXRlbSBwe21hcmdpbi10b3A6MDt0ZXh0LWRlY29yYXRpb246bm9uZX0ucG9zdCBoMSwucG9zdCBoMiwucG9zdCBoM3tmb250LWZhbWlseTpzYW5zLXNlcmlmO2ZvbnQtd2VpZ2h0OjkwMDtsaW5lLWhlaWdodDoxfWNvZGV7YmFja2dyb3VuZDojZWVlfWNvZGVbY2xhc3MqPWxhbmd1YWdlLV0scHJlW2NsYXNzKj1sYW5ndWFnZS1de2ZvbnQtc2l6ZToxNnB4O2xpbmUtaGVpZ2h0OjEuMzc1O2RpcmVjdGlvbjpsdHI7dGV4dC1hbGlnbjpsZWZ0O3doaXRlLXNwYWNlOnByZTt3b3JkLXNwYWNpbmc6bm9ybWFsO3dvcmQtYnJlYWs6bm9ybWFsOy1tb3otdGFiLXNpemU6Mjstby10YWItc2l6ZToyO3RhYi1zaXplOjI7LXdlYmtpdC1oeXBoZW5zOm5vbmU7LW1vei1oeXBoZW5zOm5vbmU7LW1zLWh5cGhlbnM6bm9uZTtoeXBoZW5zOm5vbmU7YmFja2dyb3VuZDojMjcyODIyO2NvbG9yOiNmOGY4ZjJ9cHJlW2NsYXNzKj1sYW5ndWFnZS1de3BhZGRpbmc6MS41ZW07bWFyZ2luOi41ZW0gMDtvdmVyZmxvdzphdXRvfTpub3QocHJlKT5jb2RlW2NsYXNzKj1sYW5ndWFnZS1de3BhZGRpbmc6LjFlbTtib3JkZXItcmFkaXVzOi4zZW19LnRva2VuLmNvbW1lbnQsLnRva2VuLnByb2xvZywudG9rZW4uZG9jdHlwZSwudG9rZW4uY2RhdGF7Y29sb3I6Izc1NzE1ZX0udG9rZW4ucHVuY3R1YXRpb257Y29sb3I6I2Y4ZjhmMn0udG9rZW4ubmFtZXNwYWNle29wYWNpdHk6Ljd9LnRva2VuLm9wZXJhdG9yLC50b2tlbi5ib29sZWFuLC50b2tlbi5udW1iZXJ7Y29sb3I6I2ZkOTcxZn0udG9rZW4ucHJvcGVydHl7Y29sb3I6I2Y0YmY3NX0udG9rZW4udGFne2NvbG9yOiM2NmQ5ZWZ9LnRva2VuLnN0cmluZ3tjb2xvcjojYTFlZmU0fS50b2tlbi5zZWxlY3Rvcntjb2xvcjojYWU4MWZmfS50b2tlbi5hdHRyLW5hbWV7Y29sb3I6I2ZkOTcxZn0udG9rZW4uZW50aXR5LC50b2tlbi51cmwsLmxhbmd1YWdlLWNzcyAudG9rZW4uc3RyaW5nLC5zdHlsZSAudG9rZW4uc3RyaW5ne2NvbG9yOiNhMWVmZTR9LnRva2VuLmF0dHItdmFsdWUsLnRva2VuLmtleXdvcmQsLnRva2VuLmNvbnRyb2wsLnRva2VuLmRpcmVjdGl2ZSwudG9rZW4udW5pdHtjb2xvcjojYTZlMjJlfS50b2tlbi5zdGF0ZW1lbnQsLnRva2VuLnJlZ2V4LC50b2tlbi5hdHJ1bGV7Y29sb3I6I2ExZWZlNH0udG9rZW4ucGxhY2Vob2xkZXIsLnRva2VuLnZhcmlhYmxle2NvbG9yOiM2NmQ5ZWZ9LnRva2VuLmRlbGV0ZWR7dGV4dC1kZWNvcmF0aW9uOmxpbmUtdGhyb3VnaH0udG9rZW4uaW5zZXJ0ZWR7Ym9yZGVyLWJvdHRvbToxcHggZG90dGVkICNmOWY4ZjU7dGV4dC1kZWNvcmF0aW9uOm5vbmV9LnRva2VuLml0YWxpY3tmb250LXN0eWxlOml0YWxpY30udG9rZW4uaW1wb3J0YW50LC50b2tlbi5ib2xke2ZvbnQtd2VpZ2h0OmJvbGR9LnRva2VuLmltcG9ydGFudHtjb2xvcjojZjkyNjcyfS50b2tlbi5lbnRpdHl7Y3Vyc29yOmhlbHB9cHJlPmNvZGUuaGlnaGxpZ2h0e291dGxpbmU6LjRlbSBzb2xpZCAjZjkyNjcyO291dGxpbmUtb2Zmc2V0Oi40ZW19XG4iXX0= */</style>
    </head>
    <body>

        
<div class="post">
    <time class="post-date" datetime="2021-06-15">
        2021 06 15
    </time>
    <h1>Optimizing SVG icon system in Preact</h1>
    <p>After <a href="https://twitter.com/_developit/status/1382838799420514317">this tweet from Jason Miller</a> I jumped at opportunity to optimize <a href="https://withhugo.com">Hugo</a> icon system. Our SVG icons were saved as <a href="https://css-tricks.com/creating-svg-icon-system-react/">Preact components</a> and it bothered me that a) each icon was blowing up bundle size and b) even with route splitting in place all icons were ending up in main bundle.</p>
<h2 id="using-symbols">Using symbols <a class="direct-link" href="#using-symbols">#</a></h2>
<p>First step was extracting all icons from JSX back into separate SVG files. This made it easier to add new icons and optimize using <a href="https://jakearchibald.github.io/svgomg/">SVGOMG</a>. No need to copy SVG inside component and add <code>{ ..props }</code> on <code>&lt;svg&gt;</code> tag.</p>
<p>Next, I needed to move all icons into single SVG and <a href="https://css-tricks.com/svg-symbol-good-choice-icons/">convert to <code>symbol</code></a>. For that I used <a href="https://github.com/svgstore/svgstore-cli">svgstore</a> CLI. I added command to my <code>package.json</code>:</p>
<pre class="language-bash"><code class="language-bash"><span class="token string">"svg"</span><span class="token builtin class-name">:</span> <span class="token string">"svgstore src/images/icons/**/*.svg -o src/images/icons.svg"</span></code></pre>
<p>Now, running <code>npm run svg</code> will take all icons inside my <code>images/icons</code> dir and output unified <code>icons.svg</code> file with symbols.</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2000/svg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>symbol</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>icon-alert<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>0 0 16 16<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>        <span class="token comment">&lt;!-- paths go here --></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>symbol</span><span class="token punctuation">></span></span><br><br>    <span class="token comment">&lt;!-- other symbols --></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span></code></pre>
<h2 id="creating-icon-components">Creating icon components <a class="direct-link" href="#creating-icon-components">#</a></h2>
<p>In Preact, my icon components looked like this:</p>
<pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">IconAlert</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span><br>        <span class="token attr-name">aria-hidden</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span> <span class="token boolean">true</span> <span class="token punctuation">}</span></span><br>        <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2000/svg<span class="token punctuation">"</span></span><br>        <span class="token spread"><span class="token punctuation">{</span> <span class="token punctuation">...</span><span class="token attr-value">props</span> <span class="token punctuation">}</span></span><br>    <span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#icon-alert<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"><br>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><br><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>To avoid repeating similar code block for every icon, I optimized it like so:</p>
<pre class="language-jsx"><code class="language-jsx"><br><span class="token keyword">const</span> <span class="token function-variable function">SvgIcon</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> className<span class="token punctuation">,</span> use<span class="token punctuation">,</span> <span class="token operator">...</span>rest <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span><br>        <span class="token attr-name">aria-hidden</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span> <span class="token boolean">true</span> <span class="token punctuation">}</span></span><br>        <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span> <span class="token function">classnames</span><span class="token punctuation">(</span>className<span class="token punctuation">,</span> use<span class="token punctuation">)</span> <span class="token punctuation">}</span></span><br>        <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2000/svg<span class="token punctuation">"</span></span><br>        <span class="token spread"><span class="token punctuation">{</span> <span class="token punctuation">...</span><span class="token attr-value">rest</span> <span class="token punctuation">}</span></span><br>    <span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name">href</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">#</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span> use <span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"><br>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><br><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">IconAlert</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">SvgIcon</span></span> <span class="token attr-name">use</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>icon-alert<span class="token punctuation">"</span></span> <span class="token spread"><span class="token punctuation">{</span> <span class="token punctuation">...</span><span class="token attr-value">props</span> <span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span></code></pre>
<p>With <code>SvgIcon</code> I can create new icons by referencing their <code>id</code> from SVG map and I would also get CSS class of the same name that I can use for styling.</p>
<h2 id="load-and-cache-svg-map">Load and cache SVG map <a class="direct-link" href="#load-and-cache-svg-map">#</a></h2>
<p>Initially, I imported icon map into my main HTML template. This template was used by webpack to generate my main HTML file and was chaning on every build and deploy. I wanted to leverage the fact that icons change at lower frequence than rest of the product and cache them in the browser. But I also needed a way to serve fresh map when icons are modified.</p>
<p>Assets pulled through webpack are outputted with hash-based names on build. I could use <code>import</code> to get hashed icon map and then inject it into my HTML. I did that in my root <code>&lt;App /&gt;</code> component:</p>
<pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> icons <span class="token keyword">from</span> <span class="token string">'../images/icons.svg'</span><span class="token punctuation">;</span><br><br><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token function">fetch</span><span class="token punctuation">(</span>icons<span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resp</span><span class="token punctuation">)</span> <span class="token operator">=></span> resp<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">html</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> parser <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DOMParser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">const</span> documentNode <span class="token operator">=</span> parser<span class="token punctuation">.</span><span class="token function">parseFromString</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">'image/svg+xml'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>documentNode<span class="token punctuation">.</span>documentElement<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><br>    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=></span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><code>useEffect</code> with empty dependecy array will execute just once, on page load, when app is mounted.</p>
<h2 id="closing-notes">Closing notes <a class="direct-link" href="#closing-notes">#</a></h2>
<ol>
<li>
<p>File output from <code>svgstore</code> doesn't have <code>style=&quot;display: none;&quot;</code> on <code>svg</code> tag so if you don't wanna SVG map taking up empty space on the page, add <code>body &gt; svg { display: none; }</code> inside <code>&lt;style&gt;</code> tags in document <code>&lt;head&gt;</code>. I prefer <code>&lt;style&gt;</code> tag over external CSS to avoid any flashes and layout reshuffling.</p>
</li>
<li>
<p>This approach requires setting <code>width</code> and <code>height</code> on every icon. If all icons are same size this can be easy as setting common <code>.svg-icon</code> class in CSS. If each icon is different (as they are in my case) size can be set either via dedicated CSS classes or by passing <code>width</code> and <code>heigh</code> as props on <code>SvgIcon</code>.</p>
</li>
</ol>

</div>


    </body>
</html>
